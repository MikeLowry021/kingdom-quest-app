(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{1290:()=>{},2940:(e,t,r)=>{Promise.resolve().then(r.bind(r,6526)),Promise.resolve().then(r.t.bind(r,318,23)),Promise.resolve().then(r.t.bind(r,9667,23)),Promise.resolve().then(r.t.bind(r,1290,23))},6526:(e,t,r)=>{"use strict";r.d(t,{ClientProviders:()=>p});var n=r(5155),i=r(2115),o=r(5040),a=r(5704);let s=a.env.NEXT_PUBLIC_SUPABASE_URL,l=a.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;s&&l||console.warn("Missing Supabase environment variables, using fallback values");let u=(0,o.UU)(s||"https://placeholder.supabase.co",l||"placeholder_key",{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,flowType:"pkce",storageKey:"sb-auth-token"},realtime:{params:{eventsPerSecond:2}},db:{schema:"public"},global:{headers:{"X-Client-Info":"kingdomquest-web"}}}),c=(0,i.createContext)(void 0);function d(e){let{children:t}=e,[r,o]=(0,i.useState)(!1),[a,s]=(0,i.useState)(null),[l,d]=(0,i.useState)(null),[h,f]=(0,i.useState)(!0),[p,g]=(0,i.useState)(!1);(0,i.useEffect)(()=>{o(!0)},[]),(0,i.useEffect)(()=>{if(!r)return;let e=!0;(async()=>{try{let{data:{session:t},error:r}=await u.auth.getSession();if(r)return void console.error("Error getting session:",r);if(!e)return;(null==t?void 0:t.user)?(s(t.user),await w(t.user.id)):(s(null),d(null))}catch(t){console.error("Error initializing auth:",t),e&&(s(null),d(null))}finally{e&&(f(!1),g(!0))}})();let{data:{subscription:t}}=u.auth.onAuthStateChange(async(t,r)=>{if(e)try{(null==r?void 0:r.user)?(s(r.user),await w(r.user.id)):(s(null),d(null))}catch(e){console.error("Error in auth state change:",e)}finally{e&&f(!1)}});return()=>{e=!1,t.unsubscribe()}},[r]);let w=async e=>{try{let{data:t,error:r}=await u.from("profiles").select("*").eq("id",e).maybeSingle();if(r&&"PGRST116"!==r.code)return void console.error("Error loading profile:",r);d(t)}catch(e){console.error("Error loading profile:",e)}},y=async(e,t)=>{let{data:r,error:n}=await u.auth.signUp({email:e,password:t,options:{emailRedirectTo:"".concat(window.location.origin,"/auth/callback")}});return{data:r,error:n}},b=async(e,t)=>{let{data:r,error:n}=await u.auth.signInWithPassword({email:e,password:t});return{data:r,error:n}},m=async e=>{let{data:t,error:r}=await u.auth.signInWithOtp({email:e,options:{emailRedirectTo:"".concat(window.location.origin,"/auth/callback")}});return{data:t,error:r}},v=async()=>{let{error:e}=await u.auth.signOut();if(e)throw console.error("Error signing out:",e),e},S=async e=>{if(!a)throw Error("No user logged in");let{data:t,error:r}=await u.from("profiles").update(e).eq("id",a.id).select().maybeSingle();if(r)throw r;t&&d(t)},E=(0,i.useMemo)(()=>({user:a,profile:l,loading:!r||h,signUp:y,signIn:b,signInWithMagicLink:m,signOut:v,updateProfile:S}),[a,l,h,r]);return(0,n.jsx)(c.Provider,{value:E,children:t})}var h=r(8720);function f(e){let{children:t}=e,[r,o]=(0,i.useState)(!1),[a,s]=(0,i.useState)(!0);return(0,i.useEffect)(()=>{o(!0);let e=setTimeout(()=>{s(!1)},100);return()=>clearTimeout(e)},[]),(0,i.useMemo)(()=>(0,n.jsxs)("div",{className:"min-h-screen ".concat(a?"opacity-0":"opacity-100"," transition-opacity duration-300"),suppressHydrationWarning:!0,children:[t,(0,n.jsx)(h.l$,{position:"top-right",richColors:!0})]}),[t,a])}function p(e){let{children:t}=e;return(0,n.jsx)(f,{children:(0,n.jsx)(d,{children:t})})}}},e=>{e.O(0,[386,150,441,255,358],()=>e(e.s=2940)),_N_E=e.O()}]);